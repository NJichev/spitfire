#!/usr/bin/env elixir

Mix.install([
  :benchee,
  {:spitfire, path: "."}
])


defmodule Bench do
  def run() do
    Benchee.run(
      %{
        "Spitfire.parse!" => fn input -> Spitfire.parse!(input) end,
        "Code.string_to_quoted!" => fn input -> Code.string_to_quoted!(input, columns: true, token_metadata: true) end
      },
      inputs: %{
        "small file" => File.read!("mix.exs"),
        "medium file" => File.read!("lib/spitfire.ex"),
        "big file" => File.read!("/home/mitchell/src/elixir/lib/elixir/lib/enum.ex"),
      }
    )
  end
  def thing(one, two, three, four) do
    :ok
  end

  def mapvlist() do
    Benchee.run(
      %{
        "map access" => fn input -> 
          map = %{foo: true, boo: false}
          map[input]
        end,
        "list access" => fn input ->
          list = [foo: true, boo: false]
          list[input]
        end,

        "no access" => fn _input ->
          thing(true, false, true, false)
        end
      },
      inputs: %{
        ":foo" => :foo,
        ":bar" => :bar,
        ":baz" => :baz,
        ":boo" => :boo,
      }
    )
  end
end

Bench.run()
